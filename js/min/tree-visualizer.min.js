!function(e){e.fn.treeVisualizer=function(t,a){function o(){var e=[],t=[],a=[];if(V.normalView){z.append('<div class="tree-visualizer"></div>'),m=z.children(".tree-visualizer");var o='<div class="tv-error" style="display: none"><p></p></div><div class="tree" style="font-size: '+V.nvFontSize+'px;"></div><aside class="tooltip" style="display: none"><ul></ul><button><i class="fa fa-times"></i></button></aside>';V.fsView&&(o+='<button class="tv-show-fs"><i class="fa fa-arrows-alt"></i></button>'),m.append(o),g=m.children(".tree"),y=m.children(".tooltip"),a.push(m),e.push(g),t.push(y)}if(V.fsView){z.append('<div class="tree-visualizer-fs" style="display: none"></div>'),v=z.children(".tree-visualizer-fs");var n="";V.normalView||(n+='<div class="tv-error" style="display: none"><p></p></div>'),n+='<div class="tree" style="font-size: '+V.fsFontSize+'px;"></div><aside class="tooltip" style="display: none"><ul></ul><button><i class="fa fa-times"></i></button></aside><div class="zoom-opts"><button class="zoom-out"><i class="fa fa-search-minus" aria-hidden="true"></i></button><button class="zoom-default">Default</button><button class="zoom-in"><i class="fa fa-search-plus" aria-hidden="true"></i></button><button class="close"><i class="fa fa-times"></i></button></div>',v.append(n),$=v.children(".tree"),b=v.children(".tooltip"),C=v.children(".zoom-opts"),""!=V.sentence&&($.before('<div class="sentence">'+decodeURI(V.sentence)+"</div>"),x=v.children(".sentence")),a.push(v),e.push($),t.push(b)}w=f(e),k=f(t),anyView=f(a),errorContainer=anyView.children(".tv-error")}function n(t){e.ajax({type:"GET",url:t,dataType:"xml"}).done(function(e){null==e?h("Your XML appears to be empty or not in a compatible format."):i(e)}).fail(function(e){var t="";t=0===e.status?"Not connect to the Internet.<br>Verify your network connection.":404==e.status?"Requested XML file not found.<br>Try again with another query.":500==e.status?"Internal Server Error.<br>If the problem persists, contact us.":"Uncaught Error.<br>Please try again at another time.",h(t)}).always(function(){V.normalView&&z.addClass("active"),V.initFSOnClick&&(e(".loading-wrapper.tv").removeClass("active"),v.fadeIn(250),p())})}function i(t){var a=e(t);u(),w.html(s(a.find("node").first())),k.children("ul").empty(),r()}function s(t){var a=e("<ol/>");return t.each(function(t,o){for(var n=e('<li><a href="#"></a></li>'),i=0,r=o.attributes.length,l=null;r>i;i++)l=o.attributes[i],"highlight"==l.nodeName?n.addClass("highlight"):"begin"!=l.nodeName&&"end"!=l.nodeName&&n.attr("data-"+l.nodeName,l.value.replace(/^\s(.+)/g,"$1"));e(this).children("node").length&&n.append(s(e(this).children("node"))),a.append(n)}),a}function r(){w.find("a").each(function(){var t=e(this),a=t.parent("li");a.data("rel")&&(t.append("<span>"+a.data("rel")+"<span>"),a.data("index")&&t.append("<span>"+a.data("index")+"</span>")),a.data("postag")&&V.extendedPOS?t.append("<span>"+a.data("postag")+"</span>"):a.data("pt")?a.data("index")?t.children("span:last-child").append(":"+a.data("pt")):t.append("<span>"+a.data("pt")+"</span>"):a.data("cat")&&(a.data("index")?t.children("span:last-child").append(":"+a.data("cat")):t.append("<span>"+a.data("cat")+"</span>")),t.is(":only-child")&&(a.data("lemma")&&a.append("<span>"+a.data("lemma")+"</span>"),a.data("word")&&a.append("<span><em>"+a.data("word")+"</em></span>"),t.addClass("only-child"))}),w.find("li:only-child").addClass("only-child"),w.find("li:first-child").addClass("first-child"),w.find("li:last-child").addClass("last-child")}function l(){var e=parseInt($.css("fontSize"),10);4>=e?C.find("button.zoom-out").prop("disabled",!0):e>=32?C.find("button.zoom-in").prop("disabled",!0):(C.find("button").prop("disabled",!1),$.removeClass("small x-small")),8>=e&&($.addClass("small"),4>=e&&$.addClass("x-small"))}function d(e){if($.is(":visible")){if("zoom-default"==e)$.css("fontSize",V.fsFontSize+"px");else{var t=parseInt($.css("fontSize"),10);"zoom-in"==e?$.css("fontSize",t+2+"px"):"zoom-out"==e&&$.css("fontSize",t-2+"px")}l()}}function c(e){var t;if("undefined"!=typeof $&&$.is(":visible")?t=$:"undefined"!=typeof g&&g.is(":visible")&&(t=g),"undefined"!=typeof t){var a=t.find("a.hovered");if(a.length){var o=t.next(".tooltip"),n=a[0].getBoundingClientRect(),i=t[0].getBoundingClientRect(),s={top:n.top,right:n.left+i.width,bottom:n.top+i.height,left:n.left,w:n.width,h:n.height},r={top:i.top,right:i.left+i.width,bottom:i.top+i.height,left:i.left,w:i.width,h:i.height};e?o.animate({left:parseInt(s.left+s.w/2-o.outerWidth()/2+7.5,10),top:parseInt(s.top-o.outerHeight()-24,10)},250):o.css({left:parseInt(s.left+s.w/2-o.outerWidth()/2+7.5,10),top:parseInt(s.top-o.outerHeight()-24,10)}),s.left+s.w/2<r.left||s.right+s.w/2<r.right||s.top+s.h/2<r.top||s.bottom+s.h<r.bottom?o.fadeOut(400):o.fadeIn(250)}}}function p(){if($.is(":visible")){var e=parseInt($.css("paddingRight"),10)||0,t=parseInt($.css("paddingLeft"),10)||0,a=parseInt($.css("paddingTop"),10)||0,o=parseInt($.css("paddingBottom"),10)||0,n=parseInt(v.css("paddingRight"),10)||0,i=parseInt(v.css("paddingLeft"),10)||0,s=parseInt(v.css("paddingTop"),10)||0,r=parseInt(v.css("paddingBottom"),10)||0,l=$.children("ol"),d=I;$.css({width:l[0].getBoundingClientRect().width+e+t,width:l[0].getBoundingClientRect().width+e+t,height:l[0].getBoundingClientRect().height+a+o,"max-width":d.width()-n-i,"max-height":d.height()-s-r}),""!=V.sentence&&($.css("max-height",d.height()-s-r-2*x[0].getBoundingClientRect().height),x.css("max-width",$[0].getBoundingClientRect().width))}}function h(e){errorContainer.children("p").html(e).parent().fadeIn(250),V.normalView&&(g.hide(),m.children(".tv-show-fs").prop("disabled",!0).hide()),V.fsView&&$.hide()}function u(){errorContainer.hide(),$.show(),V.normalView&&m.children(".tv-show-fs").prop("disabled",!1).show()}function f(t){return e(e.map(t,function(e){return e.get()}))}var v,m,$,g,b,y,w,k,C,x,S={normalView:!0,nvFontSize:12,fsView:!0,fsFontSize:14,sentence:"",initFSOnClick:!1,extendedPOS:!1},V=e.extend({},S,a),z=this,I=e(window);V.normalView||V.fsView?(z.children(".tree-visualizer, .tree-visualizer-fs").remove(),o(),n(t)):console.error("Cannot initialize Tree Visualizer: either the container does not exist, or you have set both normal and fullscreen view to false, which does not make sense."),V.initFSOnClick||z.find(".tv-show-fs").click(function(e){k.css("top","-100%").children("ul").empty(),"undefined"!=typeof g&&g.find("a").removeClass("hovered"),v.fadeIn(250),p(),e.preventDefault()}),w.add(I).scroll(function(){c()}),v.click(function(t){var a=e(t.target);a.closest(".tv-error, .tree, .tooltip, .zoom-opts, .sentence").length||(v.fadeOut(250,function(){$.find("a").removeClass("hovered"),u()}),V.initFSOnClick&&history.replaceState("",document.title,window.location.pathname+window.location.search))}),C.find("button").click(function(){var t=e(this);if(t.is(".close"))v.fadeOut(250,function(){$.find("a").removeClass("hovered"),u()}),V.initFSOnClick&&history.replaceState("",document.title,window.location.pathname+window.location.search);else{d(t.attr("class").match(/\b(zoom-[^\s]+)\b/)[0]),p();var a=$.find("a.hovered").css("transition-duration")||200;a=String(a).indexOf("ms")>-1?parseFloat(a):1e3*parseFloat(a),a+=50,setTimeout(function(){c(!0)},a)}}),V.fsView&&I.on("resize",p),w.on("click","a",function(t){var a=e(this),o=a.parent("li"),n=o.data(),i=a.closest(".tree"),s=i.find("a"),r=i.next(".tooltip").children("ul");r.empty(),s.removeClass("hovered"),a.addClass("hovered");var l;for(l in n)n.hasOwnProperty(l)&&e("<li>",{html:"<strong>"+l+"</strong>: "+n[l]}).prependTo(r);c(),t.preventDefault()}),w.on("mouseout","a.hovered",function(){var t=e(this);t.closest(".tree").hasClass("small")&&t.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){c(!0)})}),k.find("button").click(function(){var t=e(this),a=t.parent(".tooltip"),o=a.prev(".tree"),n=o.find("a");a.fadeOut(250),n.removeClass("hovered")})}}(jQuery);
