$(document).ready(function(){function t(){$(".loading-wrapper.searching").addClass("active"),$.get(phpVars.fetchResultsPath,function(r){var o=$.parseJSON(r);$(".results-wrapper tbody .added").removeClass("added"),o.data?(i||d||t(),$.each(o.data,function(t,e){s++;var r=e[0];r=r.replace(/\bhref=\"([^"]+)\"/,'href="#tv-'+s+'" data-tv-url="$1"'),$(".results-wrapper tbody").append('<tr class="added"><td>'+r+"</td><td>"+e[1]+"</td></tr>")}),$(".results-wrapper").fadeIn("fast"),resultIDString=e(s),$(".count strong").text(resultIDString)):($(".loading-wrapper.searching").removeClass("active"),$(".messages").addClass("active"),o.error?($(".btn-wrapper").remove(),$(".error p").text("Error! "+o.error_msg),$(".error").addClass("active")):0==$(".results-wrapper tbody").children().length?($(".btn-wrapper").remove(),$(".error p").text("No results found!"),$(".error").addClass("active")):($(".notice p").text("All results have been found!"),$(".btn-wrapper").find("button, input").prop("disabled",!0),$(".btn-wrapper").find("label").addClass("disabled"),$(".notice").addClass("active")),d=!0)})}function e(t){return t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}function r(){p.hasClass("scroll")||(u=p[0].getBoundingClientRect().top+p.scrollTop(),h=p[0].getBoundingClientRect().height,f.height(h))}function o(){var t=$(window);t.scrollTop()>=u?(f.addClass("active"),p.addClass("scroll")):(f.removeClass("active"),p.removeClass("scroll"))}var n=window.location.hash,a=$("a.tv-show-fs"),s=0,i=!1,l=$('[name="continue-bg"]'),d=!1;if(t(),setTimeout(function(){$.get(phpVars.fetchCountsPath,function(t){t&&(t=e(t),$(".count strong + span").text(t))})},5e3),n&&1==n.indexOf("tv-")){var c=n.match(/\d+$/);a.eq(c[0]-1).click()}$(".results-wrapper tbody").on("click","a.tv-show-fs",function(t){var e=$(this);$(".loading-wrapper.tv").addClass("active"),window.history.replaceState("",document.title,window.location.pathname+e.attr("href")),body.treeVisualizer(e.data("tv-url"),{normalView:!1,initFSOnClick:!0}),t.preventDefault()}),$(".stop").click(function(){i||d||($(".loading-wrapper.searching").removeClass("active"),i=!0,$(".continue").prop("disabled",!1),$(this).prop("disabled",!0))}),$(".continue").click(function(){i&&!d&&(i=!1,$(".stop").prop("disabled",!1),$(this).prop("disabled",!0),t())}),$("[name='to-top']").click(function(){$("html, body").animate({scrollTop:0})});var p=$(".controls"),u=p[0].getBoundingClientRect().top+p.scrollTop(),h=p[0].getBoundingClientRect().height,f=$(".dummy-controls");f.height(h),$(window).resize($.throttle(250,r)),$(window).scroll($.throttle(250,o)),$(window).focus(function(){l.is(":checked")||$(".continue").click()}).blur(function(){l.is(":checked")||$(".stop").click()})});
