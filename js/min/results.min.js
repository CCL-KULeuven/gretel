$(document).ready(function(){function e(){$(".loading-wrapper.searching").addClass("active"),$.get(phpVars.fetchResultsPath,function(t){var i=$.parseJSON(t);$(".results-wrapper tbody .added").removeClass("added"),i.data?(s||l||e(),$.each(i.data,function(e,a){n++;var t=a[0];t=t.replace(/\bhref=\"([^"]+)\"/,'href="#tv-'+n+'" data-tv-url="$1"'),$(".results-wrapper tbody").append('<tr class="added"><td>'+t+"</td><td>"+a[1]+"</td></tr>")}),$(".results-wrapper").fadeIn("fast"),resultIDString=a(n),$(".count strong").text(resultIDString)):(i.error?($(".btn-wrapper").remove(),$(".error p").text("Error! "+i.error_msg),$(".error").fadeIn("slow")):0==$(".results-wrapper tbody").children().length?($(".btn-wrapper").remove(),$(".error p").text("No results found!"),$(".error").fadeIn("slow")):($(".notice p").text("All results have been found!"),$(".btn-wrapper").find("button, input").prop("disabled",!0),$(".btn-wrapper").find("label").addClass("disabled")),$(".loading-wrapper.searching").removeClass("active"),l=!0)})}function a(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}var t=window.location.hash,i=$("a.tv-show-fs"),n=0,s=!1,o=$('[name="continue-bg"]'),l=!1;if(e(),setTimeout(function(){$.get(phpVars.fetchCountsPath,function(e){e&&(e=a(e),$(".count span").text(e))})},5e3),t&&1==t.indexOf("tv-")){var r=t.match(/\d+$/);i.eq(r[0]-1).click()}$(".results-wrapper tbody").on("click","a.tv-show-fs",function(e){var a=$(this);$(".loading-wrapper").addClass("active"),window.history.replaceState("",document.title,window.location.pathname+a.attr("href")),body.treeVisualizer(a.data("tv-url"),{normalView:!1,initFSOnClick:!0}),e.preventDefault()}),$(".stop").click(function(){s||l||($(".loading-wrapper.searching").removeClass("active"),s=!0,$(".continue").prop("disabled",!1),$(this).prop("disabled",!0))}),$(".continue").click(function(){s&&!l&&(s=!1,$(".stop").prop("disabled",!1),$(this).prop("disabled",!0),e())}),$(window).focus(function(){o.is(":checked")||$(".continue").click()}).blur(function(){o.is(":checked")||$(".stop").click()});var c=$(".controls")[0].getBoundingClientRect().top+$(".controls").scrollTop(),d=$(".controls")[0].getBoundingClientRect().height,h=$(".dummy-controls");h.height(d),$(window).scroll(function(){var e=$(this);e.scrollTop()>=c?(h.addClass("active"),$(".controls").addClass("scroll")):(h.removeClass("active"),$(".controls").removeClass("scroll"))}),$("[name='to-top']").click(function(){$("html, body").animate({scrollTop:0})})});
